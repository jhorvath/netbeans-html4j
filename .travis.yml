#
# Licensed to the Apache Software Foundation (ASF) under one
# or more contributor license agreements.  See the NOTICE file
# distributed with this work for additional information
# regarding copyright ownership.  The ASF licenses this file
# to you under the Apache License, Version 2.0 (the
# "License"); you may not use this file except in compliance
# with the License.  You may obtain a copy of the License at
#
#   http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing,
# software distributed under the License is distributed on an
# "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
# KIND, either express or implied.  See the License for the
# specific language governing permissions and limitations
# under the License.
#
language: java
services:
  - xvfb
before_install:
  - sudo apt-get -qq update || echo no sudo apt-get
  - sudo apt-get install -y libwebkitgtk-3.0-0 || echo no sudo apt-get
  - if [ -n "$URL" ]; then pushd /tmp; curl $URL -o jdk.tgz; tar fxz jdk.tgz; JAVA_HOME=`pwd`/$DIR; popd; export JAVA_HOME; fi
  - echo Java is $JAVA_HOME
  - ls -l $JAVA_HOME
before_script:
  - export DISPLAY=:99.0
  - sh -e /etc/init.d/xvfb start || echo No X11
  - sleep 3
script:
  - java -version
  - mvn install -DskipTests $ARGS
  - mvn verify $ARGS

matrix:
  include:
    - name: JDK8 on 14.04
      os: linux
      dist: trusty
      jdk: openjdk8
      env:
        - ARGS=-Dnone
        - DIR=zulu8.40.0.25-ca-fx-jdk8.0.222-linux_x64
        - URL=https://cdn.azul.com/zulu/bin/zulu8.40.0.25-ca-fx-jdk8.0.222-linux_x64.tar.gz

    - name: JDK8 on 18.04
      os: linux
      dist: bionic
      jdk: openjdk11
      env:
        - ARGS=-Dnone
        - DIR=zulu8.40.0.25-ca-fx-jdk8.0.222-linux_x64
        - URL=https://cdn.azul.com/zulu/bin/zulu8.40.0.25-ca-fx-jdk8.0.222-linux_x64.tar.gz

    - name: JDK8 on 19.10
      os: linux
      dist: eoan
      jdk: openjdk11
      env:
        - ARGS=-Dnone
        - DIR=zulu8.40.0.25-ca-fx-jdk8.0.222-linux_x64
        - URL=https://cdn.azul.com/zulu/bin/zulu8.40.0.25-ca-fx-jdk8.0.222-linux_x64.tar.gz

    - name: JDK11 on 14.04
      os: linux
      dist: trusty
      jdk: openjdk11
      env:
        - ARGS=-Dnone

    - name: JDK11 on Mac OS X
      os: osx
      osx_image: xcode9.3
      jdk: openjdk11
      env:
        - ARGS=-Dnone

